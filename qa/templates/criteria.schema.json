{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Acceptance Criteria Template Schema",
  "description": "Schema for defining reusable acceptance criteria templates in BuildRunner QA system",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier for the template"
    },
    "title": {
      "type": "string",
      "minLength": 1,
      "maxLength": 200,
      "description": "Human-readable title for the template"
    },
    "description": {
      "type": "string",
      "maxLength": 1000,
      "description": "Detailed description of what this template covers"
    },
    "category": {
      "type": "string",
      "enum": [
        "ui_component",
        "api_endpoint",
        "authentication",
        "data_validation",
        "performance",
        "security",
        "accessibility",
        "integration",
        "user_workflow",
        "error_handling",
        "mobile_responsive",
        "cross_browser",
        "database_operation",
        "file_upload",
        "notification",
        "reporting",
        "backup_recovery",
        "deployment",
        "monitoring",
        "compliance"
      ],
      "description": "Category classification for the template"
    },
    "criteria": {
      "type": "array",
      "minItems": 1,
      "maxItems": 20,
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for this criterion within the template"
          },
          "description": {
            "type": "string",
            "minLength": 1,
            "maxLength": 500,
            "description": "Clear, testable acceptance criterion"
          },
          "type": {
            "type": "string",
            "enum": [
              "functional",
              "visual",
              "performance",
              "security",
              "accessibility",
              "usability",
              "compatibility",
              "data_integrity",
              "error_handling",
              "integration"
            ],
            "description": "Type of acceptance criterion"
          },
          "priority": {
            "type": "string",
            "enum": ["P1", "P2", "P3"],
            "default": "P2",
            "description": "Priority level for this criterion"
          },
          "automation_level": {
            "type": "string",
            "enum": ["manual", "semi_automated", "fully_automated"],
            "default": "manual",
            "description": "Level of automation possible for this criterion"
          },
          "test_method": {
            "type": "string",
            "enum": [
              "unit_test",
              "integration_test",
              "e2e_test",
              "visual_test",
              "manual_test",
              "performance_test",
              "security_test",
              "accessibility_test"
            ],
            "description": "Recommended testing method"
          },
          "expected_result": {
            "type": "string",
            "maxLength": 300,
            "description": "Expected outcome when criterion is met"
          },
          "test_data": {
            "type": "object",
            "description": "Sample test data or parameters needed",
            "additionalProperties": true
          },
          "dependencies": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Other criteria IDs that must pass first"
          }
        },
        "required": ["id", "description", "type", "expected_result"],
        "additionalProperties": false
      },
      "description": "Array of acceptance criteria for this template"
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string",
        "pattern": "^[a-z0-9_-]+$",
        "maxLength": 50
      },
      "maxItems": 10,
      "description": "Tags for searching and filtering templates"
    },
    "variables": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
            "description": "Variable name (used in criteria with {{variable}} syntax)"
          },
          "description": {
            "type": "string",
            "maxLength": 200,
            "description": "Description of what this variable represents"
          },
          "type": {
            "type": "string",
            "enum": ["string", "number", "boolean", "url", "email"],
            "default": "string"
          },
          "default_value": {
            "description": "Default value for the variable"
          },
          "required": {
            "type": "boolean",
            "default": true
          }
        },
        "required": ["name", "description"],
        "additionalProperties": false
      },
      "description": "Template variables that can be substituted when applying template"
    },
    "usage_examples": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string",
            "maxLength": 100
          },
          "description": {
            "type": "string",
            "maxLength": 300
          },
          "variable_values": {
            "type": "object",
            "description": "Example values for template variables"
          }
        },
        "required": ["title", "description"],
        "additionalProperties": false
      },
      "maxItems": 5,
      "description": "Usage examples showing how to apply this template"
    },
    "created_by": {
      "type": "string",
      "description": "User ID who created this template"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when template was created"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when template was last updated"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "default": "1.0.0",
      "description": "Semantic version of the template"
    },
    "is_active": {
      "type": "boolean",
      "default": true,
      "description": "Whether this template is active and available for use"
    }
  },
  "required": [
    "id",
    "title", 
    "category",
    "criteria",
    "created_by",
    "created_at",
    "version"
  ],
  "additionalProperties": false,
  "examples": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "title": "API Endpoint Validation",
      "description": "Standard acceptance criteria for REST API endpoints",
      "category": "api_endpoint",
      "criteria": [
        {
          "id": "api_response_format",
          "description": "API returns valid JSON response with expected schema",
          "type": "functional",
          "priority": "P1",
          "automation_level": "fully_automated",
          "test_method": "integration_test",
          "expected_result": "Response matches OpenAPI schema definition"
        },
        {
          "id": "api_error_handling",
          "description": "API returns appropriate HTTP status codes for error conditions",
          "type": "error_handling",
          "priority": "P1",
          "automation_level": "fully_automated",
          "test_method": "integration_test",
          "expected_result": "4xx for client errors, 5xx for server errors"
        }
      ],
      "tags": ["api", "rest", "validation", "json"],
      "variables": [
        {
          "name": "endpoint_path",
          "description": "The API endpoint path to test",
          "type": "string",
          "required": true
        },
        {
          "name": "expected_status",
          "description": "Expected HTTP status code",
          "type": "number",
          "default_value": 200
        }
      ],
      "created_by": "system",
      "created_at": "2025-10-30T23:30:00.000Z",
      "version": "1.0.0"
    }
  ]
}
